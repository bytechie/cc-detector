services:
  presidio-analyzer:
    image: mcr.microsoft.com/presidio-analyzer:latest
    container_name: presidio-analyzer
    ports:
      - "3000:3000"
    environment:
      - ANALYZER_LOG_LEVEL=INFO

  presidio-anonymizer:
    image: mcr.microsoft.com/presidio-anonymizer:latest
    container_name: presidio-anonymizer
    ports:
      - "3001:3001"
    environment:
      - ANONYMIZER_LOG_LEVEL=INFO

  credit-card-detector:
    build: .
    container_name: credit-card-detector
    ports:
      - "5000:5000"
    environment:
      - FLASK_ENV=production
      - SUBAGENT_MODE=full
      - PRESIDIO_ANALYZER_URL=http://presidio-analyzer:3000
      - PRESIDIO_ANONYMIZER_URL=http://presidio-anonymizer:3001
    depends_on:
      - presidio-analyzer
      - presidio-anonymizer
